name: Validate Frontmatter

on:
  pull_request:
    paths:
      - 'content/blogs/**'
      - '.github/workflows/frontmatter.yml'

jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Validate required fields
        run: |
          set -e
          for file in $(find content/blogs -name index.md 2>/dev/null || true); do
            [ -z "$file" ] && continue
            echo "Checking $file..."
            grep -q "post_id" "$file" || { echo "Missing post_id in $file"; exit 1; }
            grep -q "title:" "$file" || { echo "Missing title in $file"; exit 1; }
            grep -q "authors:" "$file" || { echo "Missing authors in $file"; exit 1; }
            grep -q "editor:" "$file" || { echo "Missing editor in $file"; exit 1; }
            grep -q "tags:" "$file" || { echo "Missing tags in $file"; exit 1; }
            grep -q "categories:" "$file" || { echo "Missing categories in $file"; exit 1; }
            grep -q "status:" "$file" || { echo "Missing status in $file"; exit 1; }
            grep -q "date_submitted" "$file" || { echo "Missing date_submitted in $file"; exit 1; }
            grep -q "revision_history:" "$file" || { echo "Missing revision_history in $file"; exit 1; }
            grep -q "author:" "$file" || { echo "Missing author (taxonomy) in $file"; exit 1; }
          done
          echo "Frontmatter validation passed."
